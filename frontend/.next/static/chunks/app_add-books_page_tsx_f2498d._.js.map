{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/jaskaransingh/projects/LibraryManagerAI/frontend/app/add-books/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useAuth } from \"../context/AuthContext\";\nimport { useRouter } from \"next/navigation\";\nimport { useState, useEffect } from \"react\";\n\n// Define Book interface to properly type the books array\ntype Book = {\n  id: number;\n  name: string;\n  author: string;\n};\n\nexport default function AddBooksPage() {\n  const { user } = useAuth();\n  const router = useRouter();\n  const [bookName, setBookName] = useState(\"\");\n  const [bookAuthor, setBookAuthor] = useState(\"\");\n  const [message, setMessage] = useState(\"\");\n  const [books, setBooks] = useState<Book[]>([]);\n\n  useEffect(() => {\n    // Redirect if user is not logged in or not an admin\n    if (!user || user.role !== \"admin\") {\n      router.push(\"/login\");\n    }\n  }, [user, router]);\n\n  const handleAddBook = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setMessage(\"\");\n\n    try {\n      const res = await fetch(\"http://localhost:3002/books\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ name: bookName, author: bookAuthor }),\n      });\n\n      const data = await res.json();\n      if (!res.ok) throw new Error(data.error || \"Failed to add book\");\n\n      setMessage(`Book \"${data.name}\" added!`);\n      setBookName(\"\");\n      setBookAuthor(\"\");\n\n      // Refresh the book list after adding a new book\n      fetchBooks();\n    } catch (err: any) {\n      setMessage(err.message || \"Failed to add book\");\n    }\n  };\n\n  const fetchBooks = async () => {\n    try {\n      const res = await fetch(\"http://localhost:3002/books\");\n      const data = await res.json();\n      setBooks(data);\n    } catch (err) {\n      console.error(\"Failed to fetch books:\", err);\n    }\n  };\n\n  const handleDeleteBook = async (id: any) => {\n    try {\n      const res = await fetch(`http://localhost:3002/books/${id}`, {\n        method: \"DELETE\",\n      });\n      if (!res.ok) throw new Error(\"Failed to delete book\");\n      setBooks(books.filter((book) => book.id !== id));\n      setMessage(\"Book deleted successfully!\");\n    } catch (err: any) {\n      setMessage(err.message);\n    }\n  };\n\n  useEffect(() => {\n    // Fetch books when component mounts\n    if (user && user.role === \"admin\") {\n      fetchBooks();\n    }\n  }, [user]);\n\n  if (!user || user.role !== \"admin\") {\n    return null; // Don't render anything while redirecting\n  }\n\n  return (\n    <div className=\"p-10 mt-8\">\n      <p className=\"mb-4 text-white\">\n        Logged in as <strong>{user.username}</strong> ({user.role})\n      </p>\n\n      <form onSubmit={handleAddBook} className=\"flex flex-col gap-3 max-w-md\">\n        <h2 className=\"text-white text-lg font-bold\">Add Book</h2>\n        <input\n          className=\"p-2 rounded bg-black text-white\"\n          placeholder=\"Book Name\"\n          value={bookName}\n          onChange={(e) => setBookName(e.target.value)}\n        />\n        <input\n          className=\"p-2 rounded bg-black text-white\"\n          placeholder=\"Author\"\n          value={bookAuthor}\n          onChange={(e) => setBookAuthor(e.target.value)}\n        />\n        <button className=\"bg-green-700 text-white p-2 rounded\">\n          Add Book\n        </button>\n        {message && <p className=\"text-green-400\">{message}</p>}\n      </form>\n\n      <div className=\"mt-8\">\n        <h2 className=\"text-white text-lg font-bold mb-4\">Manage Books</h2>\n        <div className=\"grid gap-4\">\n          {books.map((book) => (\n            <div\n              key={book.id}\n              className=\"bg-gray-800 p-4 rounded-lg flex justify-between items-center\"\n            >\n              <div>\n                <h3 className=\"text-white font-semibold\">{book.name}</h3>\n                {book.author && <p className=\"text-gray-400\">{book.author}</p>}\n              </div>\n              <button\n                onClick={() => handleDeleteBook(book.id)}\n                className=\"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700\"\n              >\n                Delete\n              </button>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 260, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}